# 도시환경 인식 조사 시스템 - 사용 설명서

## 📋 목차
1. [시스템 개요](#시스템-개요)
2. [사전 준비](#사전-준비)
3. [설치 및 설정](#설치-및-설정)
4. [사용 방법](#사용-방법)
5. [주요 기능](#주요-기능)
6. [자주 묻는 질문](#자주-묻는-질문)
7. [평가 항목 추가/수정](#평가-항목-추가수정)

---

## 시스템 개요

본 시스템은 도시환경에 대한 다차원적 인식을 평가하는 온라인 조사 플랫폼입니다.

### 핵심 기능
✅ **다중 평가 항목**: 7가지 항목(활력, 아름다움, 안전, 보행친화, 연결, 복잡, 녹지친화)
✅ **100장 기준 설문**: 사진 100장을 기준으로 설문 진행
✅ **그룹별 진행도 추적**: 성별+나이+직업군별로 진행도 자동 추적
✅ **데이터 자동 저장**: Google Sheets에 자동 저장
✅ **반응형 디자인**: 모바일 지원

---

## 사전 준비

### 1. GitHub 저장소 준비
이미지 호스팅을 위해 GitHub를 사용합니다.

```
저장소 구조:
your-repo/
└── images/
    ├── photo_001.jpg
    ├── photo_002.jpg
    └── ... (100+ 이미지)
```

**이미지 업로드 방법:**
- GitHub 웹사이트에서 저장소 > `images` 폴더 > "Add files" > "Upload files"
- 또는 Git을 사용하여 업로드

### 2. Google Sheet 생성
1. [Google Sheets](https://sheets.google.com)에서 새로운 시트 생성
2. 시트 ID 복사 (URL: `https://docs.google.com/spreadsheets/d/{SHEET_ID}/edit`)
3. "공유" > 링크 공유 설정 (필요시)

### 3. Google Apps Script 설정
1. [script.google.com](https://script.google.com) 접속
2. 새 프로젝트 생성
3. 아래 단계를 따릅니다

---

## 설치 및 설정

### 단계 1: Google Apps Script 배포

#### 1-1. Apps Script 코드 입력
1. Google Apps Script 편집기에서 기본 코드 삭제
2. `app_script.js` 파일의 모든 코드 복사 및 붙여넣기

#### 1-2. 스프레드시트 ID 입력
```javascript
// app_script.js의 상단에서 다음 부분을 찾아 수정:
const SPREADSHEET_ID = "YOUR_SHEET_ID_HERE";
// 예: const SPREADSHEET_ID = "1f0qr09_F7QteWpqYkQag1d2WVyGpO0ktwMBpuRePXDU";
```

#### 1-3. Apps Script 배포
1. 상단 메뉴: "배포" > "새 배포"
2. 유형: "웹 앱" 선택
3. "다음 사용자로 실행": 본인 계정
4. "액세스 권한이 있는 사용자": "모두"
5. "배포" 클릭
6. **배포된 URL 복사** (중요!)

예: `https://script.google.com/macros/s/AKfycbwZne...../exec`

### 단계 2: 웹 애플리케이션 설정

#### 2-1. 파일 준비
다음 3개 파일을 준비합니다:
- `index.html`
- `style.css`
- `script.js`

#### 2-2. script.js 수정
`script.js` 파일의 상단을 다음과 같이 수정합니다:

```javascript
// GitHub 저장소 정보
const GITHUB = {
  owner: "your-github-id",        // ✅ 본인 GitHub ID (예: "littledoor-ai")
  repo: "your-repo-name",          // ✅ 저장소명 (예: "survey-images")
  branch: "main",                  // ✅ 브랜치
  path: "images"                   // ✅ 이미지 폴더명
};

// Google Apps Script URL
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec";
// ✅ 위에서 배포한 URL 입력
```

#### 2-3. 웹 애플리케이션 호스팅

다음 중 하나를 선택합니다:

**옵션 A: GitHub Pages (무료, 권장)**
```
저장소 설정 > Pages > 소스: main branch
URL: https://your-username.github.io/your-repo/
```

**옵션 B: Netlify (무료)**
- [netlify.com](https://netlify.com) 가입
- GitHub 저장소 연결
- 자동 배포

**옵션 C: 로컬 서버 (개발용)**
```bash
# Python 3
python -m http.server 8000

# Node.js
npx http-server
```

---

## 사용 방법

### 일반 사용자 입장에서

1. **설문 접속**
   - 제공된 URL 접속
   - 페이지 로드 대기

2. **기본 정보 입력**
   - 성별 선택: 남성 / 여성 / 기타
   - 연령대 선택: 10대 ~ 70대 이상
   - 직업군 선택: 학생, 사무직, 서비스직 등
   - "설문 시작" 클릭

3. **사진 평가**
   - 제시된 사진을 1~5점으로 평가
   - 7가지 항목 모두 평가해야 "다음" 가능
   - 모든 사진 평가 완료 시 자동 저장

4. **진행도 추적**
   - 진행 표시: "25 / 100개" 형식
   - 같은 그룹의 다음 참가자는 중단한 부분부터 시작

### 관리자 입장에서

**데이터 확인:**
1. Google Sheets 오픈
2. "Responses" 시트: 모든 응답 데이터
3. "Participants" 시트: 참가자 정보 및 진행도

**진행도 확인:**
- Participants 시트의 "responseCount" 열에서 각 참가자의 평가 완료 건수 확인
- 100개 평가 시 진행도 100% 완료

---

## 주요 기능

### 1. 다중 평가 항목

**현재 항목 (7개):**
```
1. 활력: 활기차고 생동감 있는 정도
2. 아름다움: 미적으로 아름다운 정도
3. 안전: 교통사고 위험이 적은 정도
4. 보행친화: 보행하기 편한 정도
5. 연결: 다양한 목적지로 잘 연결된 정도
6. 복잡: 시각적으로 복잡한 정도
7. 녹지친화: 자연과 녹지가 충분한 정도
```

### 2. 그룹별 진행도 추적

**추적 기준:** 성별 + 연령대 + 직업군

**예시:**
- 10대 남성 학생이 1~25번 사진 평가
- 다음 10대 남성 학생은 26~50번부터 시작
- 20대 여성 사무직은 1번부터 시작

**구현 방식:**
- 로컬 스토리지에 진행도 저장
- 각 그룹별로 별도 추적
- 브라우저 쿠키 삭제해도 안전

### 3. 자동 데이터 저장

**저장 내용:**
- 타임스탐프
- 사용자 ID (UUID)
- 성별, 연령대, 직업군
- 사진 ID
- 7개 항목 각각의 평가 점수

**저장소:** Google Sheets의 두 가지 시트
- **Responses**: 모든 평가 응답
- **Participants**: 참가자 정보 및 통계

### 4. 100장 기준 설정

**설정 위치:** `script.js`
```javascript
const SAMPLE_SIZE = 100;  // 이 값으로 총 설문 개수 조정
```

**조정 시 주의:**
- 이미지 개수는 설정값 이상 필요
- 예: SAMPLE_SIZE = 50이면 50장 이상의 이미지 필요

---

## 평가 항목 추가/수정

### 평가 항목 변경 방법

#### 단계 1: script.js 수정

`script.js`에서 `EVALUATION_ITEMS` 배열을 찾아 수정합니다:

```javascript
const EVALUATION_ITEMS = [
  { id: 'vitality', label: '활력', description: '활기차고 생동감 있는 정도' },
  { id: 'beauty', label: '아름다움', description: '미적으로 아름다운 정도' },
  { id: 'safety', label: '안전', description: '교통사고 위험이 적은 정도' },
  { id: 'walkability', label: '보행친화', description: '보행하기 편한 정도' },
  { id: 'connectivity', label: '연결', description: '다양한 목적지로 잘 연결된 정도' },
  { id: 'complexity', label: '복잡', description: '시각적으로 복잡한 정도' },
  { id: 'greenery', label: '녹지친화', description: '자연과 녹지가 충분한 정도' }
];
```

#### 단계 2: 항목 추가 예시

새로운 항목 추가:
```javascript
const EVALUATION_ITEMS = [
  // ... 기존 항목들 ...
  { id: 'accessibility', label: '접근성', description: '장애인이 접근하기 쉬운 정도' },
  { id: 'safety', label: '안전', description: '교통사고 위험이 적은 정도' }
  // ... 추가 항목들 ...
];
```

#### 단계 3: 항목 순서 변경

배열의 순서를 변경하면 설문에서도 그 순서로 표시됩니다:
```javascript
const EVALUATION_ITEMS = [
  { id: 'safety', label: '안전', description: '교통사고 위험이 적은 정도' },  // 첫 번째
  { id: 'walkability', label: '보행친화', description: '보행하기 편한 정도' }, // 두 번째
  // ...
];
```

### 항목 수정 시 주의사항

⚠️ **중요:**
- `id` 값: 영문 소문자, 언더스코어만 사용 (예: `vitality`, `my_item`)
- `id` 변경 시 기존 데이터와 호환되지 않을 수 있습니다
- 항목은 언제든 추가/수정 가능하지만, 이전 데이터는 이전 구조 유지
- 신규 항목은 신규 응답부터 자동 적용

### 스케일 범위 변경

5점 대신 다른 범위를 사용하려면:

`script.js`에서:
```javascript
const SCALE_MIN = 1;  // 최소값
const SCALE_MAX = 5;  // 최대값 (1~5점으로 변경하려면 여기 수정)
```

---

## 자주 묻는 질문

### Q1: 이미지를 추가하고 싶어요
**A:** GitHub의 `images` 폴더에 새로운 이미지 파일 업로드하면 자동으로 인식됩니다.
- 파일명은 알파벳 순서로 정렬되므로 명확한 이름 사용 권장
- 예: `photo_001.jpg`, `photo_002.jpg`, ...

### Q2: 진행도 초기화하고 싶어요
**A:** 브라우저 개발자 도구 (F12) > Application > Local Storage에서 해당 키 삭제
```
session_남성_20대_학생  # 예: 10대 남성 학생의 진행도
```

### Q3: 동일 참가자가 다시 참여하려면?
**A:** 같은 성별/나이/직업군으로 접속하면 자동으로 이전 진행도 이어받습니다.
새로 시작하려면 위의 Q2 방법으로 진행도 초기화.

### Q4: 데이터 분석은 어떻게 하나요?
**A:** Google Sheets에서 자동으로 저장되므로 Sheets의 차트/함수로 분석 가능
```
= AVERAGE(G2:G100)  // 활력 점수 평균
= COUNTIF(H:H,">4") // 4점 이상 응답 개수
```

### Q5: 접근 권한 문제가 생겼어요
**A:** Google Apps Script 배포 설정 확인
1. "배포" > "배포 관리" > "접근 권한이 있는 사용자" > "모두" 확인
2. Google Sheet도 "공유" 설정 확인

### Q6: 점수 범위를 바꾸고 싶어요
**A:** `script.js`에서 다음 수정:
```javascript
const SCALE_MIN = 1;
const SCALE_MAX = 7;  // 예: 1~7점으로 변경
```
HTML과 CSS는 자동으로 조정됩니다.

### Q7: 모바일에서도 사용 가능한가요?
**A:** 네! 반응형 디자인으로 모바일/태블릿 지원합니다.

---

## 기술 지원

### 일반적인 문제 해결

**문제: 이미지가 로드되지 않음**
- GitHub 저장소 경로 확인: `/images/파일명`
- 파일 명확성 확인 (한글 파일명 피함)
- GitHub API 속도 제한 확인 (1시간에 60회 요청 제한)

**문제: 데이터가 저장되지 않음**
- Google Apps Script URL 확인
- 배포 권한 설정 확인
- Google Sheet 공유 설정 확인
- 브라우저 개발자 도구(F12) > Console에서 오류 메시지 확인

**문제: 진행도가 저장되지 않음**
- 브라우저 로컬 스토리지 활성화 확인
- 시크릿 모드에서는 로컬 스토리지 지원 안 함

---

## 보안 및 개인정보

- 사용자 ID: 무작위 UUID (개인 식별 정보 아님)
- 데이터: Google Sheets에 암호화 저장
- HTTPS: 배포 시 자동 보안 적용

---

## 업데이트 및 유지보수

### 정기 점검
- 이미지 개수 확인 (100개 이상 유지)
- Google Sheet 용량 확인
- 응답 데이터 백업

### 버전 업그레이드
향후 업데이트 시 기존 데이터는 유지됩니다.

---

## 지원 문의

기술 문제 발생 시:
1. 위의 "자주 묻는 질문" 참조
2. 브라우저 개발자 도구 > Console 오류 메시지 확인
3. GitHub Issues 등록

---

**마지막 업데이트:** 2024년
**버전:** 2.0 (다중 평가 항목, 그룹별 진행도 추적 기능 포함)
